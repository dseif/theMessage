<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title></title> <!-- CHANGE THE TITLE! -->
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/style.css">
  <style type="text/css">
    body {
      font-family: "edita", "Helvetica Neue", sans-serif;
       //background: url(img/facebook-egypt.jpg) repeat;
    }

    .wrapper {
      width: 100%;
      margin: 0 auto;
      position: relative;
    }

    #video, #youtube object, .column {
      width: 480px;
      z-index: 100000;
    }

    #video-container {
      width: 480px;
       z-index: 100000;
    }

    canvas {
      height: 800px !important;
      width: 800px !important;
    }
    #examples-parallax {
      position: absolute;
      height: 600px;
    }

    #blur {
      position: absolute;
      top:0;
      height: 100px;
      width: 100px;
      border: 1px solid black;
    }
    section {
      position: relative;
      background-color: #444;
      height: 1000px;
      width: 100%;
      overflow-y: hidden;
      margin-bottom: 30px;
    }

    #section-1 {
      background: #000;
    }

    #item-1-1 {
      position: absolute;
      top: 20px;
      left: 400px;
      color: #FFF;
    }

    .parallax-container {
      position: absolute;
      font-size: 2em;
      color: #FFF;
      max-width: 500px;
      
    }

    .parallax-container-off {
      text-shadow: 0 0 40px white;
      color: transparent;
      -webkit-transition: all 1s ease;
      -moz-transition: all 1s ease;
      -o-transition: all 1s ease;
      transition: all 1s ease;
    }
    .parallax-container-active {
      color: #FFF;
      text-shadow: none;
      -webkit-transition: all 1s ease;
      -moz-transition: all 1s ease;
      -o-transition: all 1s ease;
      transition: all 1s ease;
    }

    .parallax-container > div > div {
      padding: 30px;
    }

    #parallax2-1 {
      left: 50px;
      font-size: 5em;
    }

    #parallax2-2 {
      left: 260px;
    }

    #paralax2-3 {
      left: 200px;
    }

        /*
    #section-2 {
      background-color: blue;
    }
    #section-3 {
      background-color: green;
    }
    #section-4 {
      background-color: yellow;
    }

    #parallax3 {
      -webkit-transition: all 1s ease;
    }
    */
  </style>
  <script>
    document.addEventListener( "DOMContentLoaded", function( event ) {
      var buttons = document.getElementsByClassName( "sectionButtons" ),
          scrollorama = $.scrollorama({
            enablePin: false,
            blocks: ".scrollblock"
          });

      for ( var i = 0, l = buttons.length; i < l; i++ ) {
        (function( counter ) {
          buttons[ i ].addEventListener( "click", function( e ) {
            console.log( counter );
            var element = $( "#section-" + ( counter + 1 ) );
            $.scrollTo( element, 1000 * counter );
          }, false);
        })( i );
      }

      scrollorama.animate("#parallax1", {
        delay: 0,
        duration: 1000,
        property: "top",
        start: 25,
        end: 1086
      });

      scrollorama.animate("#parallax2-1", {
        delay: 0,
        duration: 2000,
        property: "top",
        start: 0,
        end: 1086,
        easing: "easeInQuad"
      });
      scrollorama.animate("#parallax2-2", {
        delay: 0,
        duration: 1400,
        property: "top",
        start: 0,
        end: 1086,
        easing: "easeInQuad"
      });
       scrollorama.animate("#parallax2-3", {
        delay: 30,
        duration: 1700,
        property: "top",
        start: 300,
        end: 1086,
        easing: "easeInQuad"
      });
  
      scrollorama.animate("#parallax3", {
        delay: 100,
        duration: 2000,
        property: "top",
        start: 0,
        end: 1086
      });
      scrollorama.animate("#parallax4", {
        delay: 0,
        duration: 2000,
        property: "top",
        start: 0,
        end: 1086
      });
            }, false);
  </script>
</head>
<body>

<div id="bg-image"></div>
<div class="wrapper">
  <div id="dev-info" style="position:fixed;bottom:10px;left:10px;background:rgba(0,0,0,.8);color:red;z-index:1000000">
    <!-- for dev: shows current scroll postiion -->
    scroll:<span id="scroll-position"></span>
    window:<span id="window-height"></span>
    doc:<span id="doc-height"></span>
  </div>

  <header>
    <h1>The Message</h1>

    <div>
      <button class="sectionButtons" id="sec1">Section 1</button>
      <button class="sectionButtons" id="sec2">Section 2</button>
      <button class="sectionButtons" id="sec3">Section 3</button>
      <button class="sectionButtons" id="sec4">Section 4</button>
    </div>
  </header>
  <div id="main" role="main">
      <!--
       <canvas id="canvas" width="300" height="300"></canvas>
              <img id="img" src="img/facebook-egypt.jpg" width="300" height="300" />
      -->
      <section id="section-1">
         <div id="item-1-1">My text</div>
       <div class="scrollblock" id="examples-parallax">
          <div id="parallax1">
              <div id="info"></div>
            </div>
          </div>
      </section>


      <section id="section-2">
        <div class="scrollblock">
          <div id="parallax2-1" class="parallax-container">
          </div>
          <div id="parallax2-2" class="parallax-container">
          </div>
          <div id="parallax2-3" class="parallax-container">
            GOOGLE MAP
          </div>
          <div>
           
          </div>
          <div class="parallax-video">
             <div id="video-container">
                <video id="video" controls> 
                    <source src="http://videos-origin.mozilla.org/serv/webmademovies/hothacks/message/NaomiKlein_TED%20TALK%20Excerpt2010.mp4">
                    <source src="http://videos-origin.mozilla.org/serv/webmademovies/hothacks/message/NaomiKlein_TED%20TALK%20Excerpt2010.mp4.webm">
                </video>
            </div>
          </div>
        </div>
   
      </div>
        </div>
        </div>
      </section>
      <section id="section-3">
        <div class="scrollblock">
          <div id="parallax3">
          
              <img  src="http://lorempixel.com/400/400/sports/1/" />
          </div>
        </div>
      </section>
      <section id="section-4">
        <div class="scrollblock">
          <div id="parallax4">
              <span>Parallax is awesome</span>
          </div>
        </div>
      </section>
  </div>
  <footer>

  </footer>
</div>
  <script src="http://popcornjs.org/code/dist/popcorn-complete.min.js"></script>
    <script>window.Popcorn || document.write('<script src="js/popcorn-complete.min.js"><\/script>')</script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.7.1.min.js"><\/script>')</script>
  <script src="js/jquery.scrollTo-min.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/jquery.scrollorama.js"></script>
  <script src="js/popcorn.supertext.js"></script>
  <script src="js/stackblur.js"></script>

  <script src="js/fastblur.js"></script>
  <script type="text/javascript" src="http://use.typekit.com/fph5scc.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script src="message.js"></script>
  <script>

      $("#doc-height").text( $(document).height() );
      $("#window-height").text( $(window).height() );
      $(window).scroll(function(e) {
        var height = window.pageYOffset;
        if ( height < 1600 &&  height > 1000 ) { 
          //console.log(map(height, 1000, 1600, 40));
          //$(".parallax-container-off").css( "textShadow", "0 0 "+map(height, 1000, 1600, 40)+"px white");
        }
        
        if ( height < 600 ) { 
          //boxBlurImage("img", "canvas", (height/600) * 10);
        }
        $("#scroll-position").text( height );
      });
      $(window).resize( function(e) {
         $("#window-height").text( $(window).height() );
      });

      var p = Popcorn( "#video" )
      .play(10).volume(0)
      .supertext({
        start: 15,
        end: 18,
        activeClass: "parallax-container-active",
        inactiveClass: "parallax-container-off",
        text: "Supremacy",
        target: "parallax2-1"
      })
      .supertext({
        start: 18,
        end: 20,
        activeClass: "parallax-container-active",
        inactiveClass: "parallax-container-off",
        text: "And it struck me that, in its own way, the bizarre ad was a crass version of our founding story—we slapped mother nature around and won. And we will always win, because dominating nature is our destiny.",
        target:"parallax2-2"
      });

      p.on( "canplayall", function( e ) {
          var section1 = $( "#section-2" ),
              duration = this.duration(),
              scrollLength = duration / section1.height(),
              instance = this;

        $(window).scroll(function(e) {
          var offset = window.pageYOffset,
              offsetTop = section1.offset().top,
              event1 = (offsetTop + ( 17 * scrollLength ) ),
              event2 = (offsetTop + ( 23 * scrollLength ) ),
              event3 = (offsetTop + ( 93 * scrollLength ) );

          if ( offset > 620 ) {
            if ( offset > event3 ) {
              instance.currentTime( 93 );
            } else if ( offset < event3 && offset > event2 ) {
              instance.currentTime( 23 );
            } else if ( offset < event2 && offset > event1 ) {
              instance.currentTime( 17 );
            } else {
              instance.currentTime( 0 );
            }
          }
          if ( offset > ( offsetTop + section1.height() ) ) {
            instance.pause();
          }
        });
      });
    </script>
  <!-- end scripts -->
</body>
</html>
