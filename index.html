<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title></title> <!-- CHANGE THE TITLE! -->
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/style.css">
  <style type="text/css">
    body {
      font-family: "edita", "Helvetica Neue", sans-serif;
       //background: url(img/facebook-egypt.jpg) repeat;
    }

    .wrapper {
      width: 100%;
      margin: 0 auto;
      position: relative;
    }

    #video, #youtube object, .column {
      width: 480px;
      z-index: 100000;
    }

    .video-container {
      width: 480px;
      margin-top: 100px;
      margin-left: 400px;
       z-index: 100000;
    }

    canvas {
      height: 800px !important;
      width: 800px !important;
    }

    #examples-parallax {
      position: absolute;
      height: 600px;
    }

    #blur {
      position: absolute;
      top:0;
      height: 100px;
      width: 100px;
      border: 1px solid black;
    }
    section {
      position: relative;
      background-color: #444;
      height: 1500px;
      width: 100%;
      overflow-y: hidden;
      margin-bottom: 30px;
    }

    section > div {
      position: absolute;
      -webkit-transition: all .1s ease;

      height: 100px;
      width: 100px;
      background: red; 
    }

    .pane-bg {
      background: black;
      width: 100%;
      height: 2000px;
    }
    .pane-bg img{
      width: 100%;
      height: 2000px;
      opacity: .2;
    }
    #pane-2-1 { left: 20%;}
    #pane-2-2 { left: 40% }
    #pane-2-3 { left: 60% }
    #pane-2-4 { left: 70% }
    #pane-2-5 { left: 80% }
    #pane-2-6 { left: 90% }

    #pane-3-1 { left: 30%;}
    #pane-3-2 { left: 40% }
    #pane-3-3 { left: 60% }
    #pane-3-4 { left: 70% }
    #pane-3-5 { left: 80% }
    #pane-3-6 { left: 90% }

  </style>
  <script>
    document.addEventListener( "DOMContentLoaded", function( event ) {
      
      //Section offsets, for scrolling
      //Pre-calculated for speed
      var sectionTop = [];
      sectionTop[2] = document.getElementById("section-2").offsetTop;
      sectionTop[3] = document.getElementById("section-3").offsetTop;


      $(window).scroll(function(e) {
        var offset = window.pageYOffset;

        //Section 2 ----------------------------------
        parallax( "pane-2-bg", 4, sectionTop[2], 900);
        //Level A - Farthest
        parallax( "pane-2-6", .8, sectionTop[2], 200);
        //Level B - Base
        parallax( "pane-2-2", 1, sectionTop[2], 300 );
        //Level C
        parallax( ["pane-2-3", "pane-2-5"], 1.25, sectionTop[2], 500 );
        //Level D
        parallax(  ["pane-2-4", "pane-2-1"], 1.5, sectionTop[2], 900 );
        
        //Section 3 ----------------------------------
        parallax( "pane-3-1", .8, sectionTop[3] );
        parallax( "pane-3-2", 1, sectionTop[3], 300 );
        parallax( ["pane-3-3", "pane-3-5"], 1.25, sectionTop[3], 500 );
        parallax(  "pane-3-4", 1.5, sectionTop[3], 300 );

      //Takes a single id or an array of ids.
      //Higher ratio = slower motion, higher position on the page.
      //If you want it to start lower, increase the adjustment number

      function parallax(ids, ratio, top, adjustment) {
        var i, j, elements = [];

        if ( typeof ids === "string") {
          elements.push( document.getElementById(ids) );
        } else {
          for(i=0; i<ids.length;i++) {
            elements.push( document.getElementById(ids[i]) );
          }
        }
        if(adjustment === undefined) {
          adjustment = 0;
        }

        for(j=0;j<elements.length;j++) {
          //Parent offset: var parentOffset = elements[j].parentNode.offsetTop;
          //elements[j].style.top = -parentOffset + adjustment + ( offset/ratio ) + "px";
          elements[j].style.top = ( -top + adjustment + (offset/ratio) ) + "px";
          console.log( elements[j].style.top );
        }
      }

    });

    }, false);
  </script>
</head>
<body>

<div id="bg-image"></div>
<div class="wrapper">
  <div id="dev-info" style="position:fixed;bottom:10px;left:10px;background:rgba(0,0,0,.8);color:red;z-index:1000000">
    <!-- for dev: shows current scroll postiion -->
    scroll:<span id="scroll-position"></span>
    window:<span id="window-height"></span>
    doc:<span id="doc-height"></span>
  </div>

  <header>
    <h1>The Message</h1>
  </header>
  <div id="main" role="main">
    <section id="section-1">
    </section>
    <section id="section-2">
      <div id="pane-2-bg" class="pane-bg"><img src="img/andromeda.png"/></div>
      <div id="pane-2-1">1</div>
      <div id="pane-2-2">2</div>
      <div id="pane-2-3">3</div>
      <div id="pane-2-4">4</div>
      <div id="pane-2-5">5</div>
      <div id="pane-2-6">6</div>
    </section>
    <section id="section-3">
      <div id="pane-3-1">1</div>
      <div id="pane-3-2">2</div>
      <div id="pane-3-3">3</div>
      <div id="pane-3-4">4</div>
      <div id="pane-3-5">5</div>
      <div id="pane-3-6">6</div>
    </section>
    <section id="section-4">
    </section>


  </div>
  <footer>

  </footer>
</div>
  <script src="http://popcornjs.org/code/dist/popcorn-complete.min.js"></script>
    <script>window.Popcorn || document.write('<script src="js/popcorn-complete.min.js"><\/script>')</script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.7.1.min.js"><\/script>')</script>
  <script src="js/jquery.scrollTo-min.js" type="text/javascript" charset="utf-8"></script>
  <script src="js/jquery.scrollorama.js"></script>
  <script src="js/popcorn.supertext.js"></script>
  <script src="js/stackblur.js"></script>

  <script src="js/fastblur.js"></script>
  <script type="text/javascript" src="http://use.typekit.com/fph5scc.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script src="message.js"></script>
  <script>

      $("#doc-height").text( $(document).height() );
      $("#window-height").text( $(window).height() );
      $(window).scroll(function(e) {
        var height = window.pageYOffset;
        if ( height < 1600 &&  height > 1000 ) { 
          //console.log(map(height, 1000, 1600, 40));
          //$(".parallax-container-off").css( "textShadow", "0 0 "+map(height, 1000, 1600, 40)+"px white");
        }
        
        if ( height < 600 ) { 
          //boxBlurImage("img", "canvas", (height/600) * 10);
        }
        $("#scroll-position").text( height );
      });
      $(window).resize( function(e) {
         $("#window-height").text( $(window).height() );
      });

    </script>
  <!-- end scripts -->
</body>
</html>
